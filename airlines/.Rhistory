,./;''
airline <- read.table("http://www.uta.fi/sis/mtt/mttts12/jags/airline.txt",h=T,sep="")
View(airline)
theme_set(theme_classic())
#install.packages("rjags","coda","Epi","lme4","pixmap","sp")
library(ggplot2)
library(ggfortify)
library(ggpubr)
library("ggmcmc")
library(rjags)
library(ggplot2)
library(knitr)
library(pander)
library(lattice)
airline <- read.table("http://www.uta.fi/sis/mtt/mttts12/jags/airline.txt",h=T,sep="")
theme_set(theme_classic())
theme_set(theme_bw())# Plot
#autoplot(airline$year) + labs(title="AirFatal") + theme(plot.title = element_text(hjust=0.5))
# Allow Default X Axis Labels
p = ggplot(airline, aes(x=year)) +
geom_line(aes(y=fatal,x =year)) +
geom_point(aes(y=fatal,x=year))+
labs(title="Time Series Chart",
subtitle="Returns fatal from 'Airlines' Dataset",
caption="Source: American Airlines",
y="Fatal")
p  + theme(axis.text.x = element_text(angle = 60, vjust = 0.5)) + scale_x_continuous("Year", labels = as.character(airline$year), breaks = airline$year)
plot( table(airline$fatal), type="h", lwd=5, lend=2, col=gray(0.5), bty="n", ylab="" )
plot( table(airline$fatal), type="h",  col=gray(0.5))
#hist( y.2002 )
plot( table(y.2002), type="h", lwd=5, lend=2, col=gray(0.5), bty="n", ylab="" )
theta <- rgamma(1000, 634, 26 )
y.2002 <- rpois(1000,theta)
#hist( y.2002 )
plot( table(y.2002), type="h", lwd=5, lend=2, col=gray(0.5), bty="n", ylab="" )
plot( table(airline$fatal), type="h",  col=gray(0.5))
hist(airline$fatal)
qplot(airline$fatal)
gghistogram(airline$fatal)
hist(airline$fatal)
hist(airline$fatal,breaks = 50)
hist(airline$fatal,breaks = 5)
hist(airline$fatal,breaks = 7)
hist(airline$fatal,breaks = 10)
hist(airline$fatal,freq = FALSE)
hist(airline$fatal,freq = TRUE)
theta <- rgamma(1000, 634, 26 )
y.2002 <- rpois(1000,theta)
#hist( y.2002 )
plot( table(y.2002), type="h", lwd=5, lend=2, col=gray(0.5), bty="n", ylab="" )
hist(airline$fatal,freq = FALSE)
hist(airline$fatal,freq = TRUE)
hist(airline$fatal,col = "lightblue")
a2.ini <- list( list( lambda=10 ),list( lambda=20 ),list( lambda=30 ) )
a2.dat <- list( fatal=c(airline$fatal,NA),miles=c(airline$miles,20), I=27 )
a2.par <- c("mu","fatal[27]")
# Model compilation and burn-in
a2.mod <- jags.model( file = "a2.jag",data = a2.dat,inits = a2.ini,n.chains = 3,n.adapt = 1000 )
# Sampling from the posterior
a2.res <- coda.samples( a2.mod,var = a2.par,n.iter = 10000,thin = 10 )
summary( a2.res )
print( xyplot( a2.res[,1:2] ) )
theta <- rgamma(6000, 634, 26 )
y.2002 <- rpois(6000,theta)
plot( table(y.2002), type="h", lwd=5, lend=2, col=gray(0.2), bty="n", ylab="", xlim=c(5,50) )
tpr <- table( as.matrix( a2.res[,"fatal[27]"] ) )
points( as.numeric(names(tpr))+0.4, tpr, type="h", col="red", lwd=4 )
result2 = ggs(a2.res)
ggs_density(result)
a3.ini <- list( list( alpha=10, beta=-0.5 ),list( alpha=20, beta=-0.6 ),list( alpha=30, beta=-0.4 ) )
a3.dat <- list( fatal=c(airline$fatal,NA),miles=c(airline$miles,20), I=27 )
a3.par <- c("alpha","beta","fatal[27]")
# Model compilation and burn-in
a3.mod <- jags.model( file = "a3.jag",data = a3.dat,inits = a3.ini,n.chains = 3,n.adapt = 1000 )
# Sampling from the posterior
a3.res <- coda.samples( a3.mod,var = a3.par,n.iter = 10000,thin = 10 )
summary( a3.res )
#print( xyplot( a3.res[,1:2] ) )
theta <- rgamma(6000, 634, 26 )
y.2002 <- rpois(6000,theta)
plot( table(y.2002), type="h", lwd=5, lend=2, col=gray(0.2), bty="n", ylab="", xlim=c(5,50) )
tpr <- table( as.matrix( a3.res[,"fatal[27]"] ) )
points( as.numeric(names(tpr))+0.4, tpr, type="h", col="red", lwd=4 )
result3 = ggs(a3.res)
ggs_density(result)
par(mfrow=c(1,2))
with(airline, plot( year, fatal, pch=16, type="b", ylim=c(0,32), bty="n" ) )
with(airline, plot( year, rate, pch=16, type="b", ylim=c(0,7), bty="n" ) )
