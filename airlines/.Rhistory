ar1_pred.dat <- list( fatal=c(airline$fatal,NA,NA,NA),
miles=c(airline$miles,miles.new),
N= 26+3)
ar1_pred.mod <- jags.model( file = "ar1_pred.jag",
data = ar1_pred.dat,
inits = ar1_pred.ini,
n.chains =1,
n.adapt = 1000 )
ar1_pred.res <- coda.samples( ar1_pred.mod,
var = ar1_pred.par,
n.iter = 10000,
thin = 10 )
ar1_pred.res <- coda.samples( model = ar1_pred.mod,
var = ar1_pred.par,
n.iter = 10000,
thin = 10 )
ar1_pred.par <- c("ar1","beta0", "beta1", "tau")
ar1_pred.mod <- jags.model( file = "ar1_pred.jag",
data = ar1_pred.dat,
inits = ar1_pred.ini,
n.chains =1,
n.adapt = 1000 )
ar1_pred.res <- coda.samples( model = ar1_pred.mod,
var = ar1_pred.par,
n.iter = 10000,
thin = 10 )
model.loc = ("lm.txt")
jagsscript = cat("
model {
mu ~ dnorm(0, 0.01);
beta ~ dnorm(0,0.01);
tau.obs ~ dgamma(0.001,0.001);
sd.obs <- 1/sqrt(tau.obs);
for(i in 1:N) {
predY[i] <- mu + C[i]*beta;
Y[i] ~ dnorm(predY[i], tau.obs);
}
}
",
file = model.loc)
jags.data = list(Y = airline$fatal, N = N, C = airline$miles)
jags.params = c("sd.obs", "predY", "mu", "beta")
mod_lm = jags(jags.data, parameters.to.save = jags.params, model.file = model.loc,
n.chains = 3, n.burnin = 5000, n.thin = 1, n.iter = 10000,
DIC = TRUE)
mod_lm = jags.model(jags.data, parameters.to.save = jags.params, model.file = model.loc,
n.chains = 3, n.burnin = 5000, n.thin = 1, n.iter = 10000,
DIC = TRUE)
jagsscript = cat("
model {
mu ~ dnorm(0, 0.01);
beta ~ dnorm(0,0.01);
tau.obs ~ dgamma(0.001,0.001);
sd.obs <- 1/sqrt(tau.obs);
for(i in 1:N) {
predY[i] <- mu + C[i]*beta;
Y[i] ~ dnorm(predY[i], tau.obs);
}
}
",
file = "model.jag")
mod_lm = jags.model(data= jags.data,  = jags.params, file = "model.jag",
n.chains = 3, n.burnin = 5000, n.thin = 1, n.iter = 10000,
DIC = TRUE)
mod_lm = jags.model(data= jags.data,  = jags.params, file = "model.jag",
n.chains = 3, n.burnin = 5000, n.thin = 1, n.iter = 10000)
jags.data = list(Y = airline$fatal, N = N, C = airline$miles)
jags.params = c("sd.obs", "predY", "mu", "beta")
jags.ini <- list( list( mu=0.1, beta=0.01,tau.obs=0.01 ),
list( mu=0.2, beta=0.02 ,tau.obs=0.02),
list( mu=0.5, beta=0.03 ,tau.obs=0.03) )
mod_lm = jags.model(data= jags.data,  = jags.params, file = "model.jag",
n.chains = 3, n.adapt = 5000, n.thin = 1, n.iter = 10000)
jags.mod <- jags.model( file = "model.jag",
data = jags.dat,
inits = jags.ini,
n.chains = 3,
n.adapt = 1000 )
jags.dat = list(Y = airline$fatal, N = N, C = airline$miles)
jags.mod <- jags.model( file = "model.jag",
data = jags.dat,
inits = jags.ini,
n.chains = 3,
n.adapt = 1000 )
jags.res <- coda.samples( jags.mod,
var = jags.params,
n.iter = 10000,
thin = 1 )
jags.data = list(Y = c(Wind, NA, NA, NA), N = (N + 3))
summary( jags.res )
jags.data = list(Y = c(airline&fatal, NA, NA, NA), N = (N + 3))
jags.data = list(Y = c(airline&fatal, NA, NA, NA), N = (N + 3))
jags.data = list(Y = c(airline$fatal, NA, NA, NA), N = (N + 3))
jags.params = c("sd.q", "sd.r", "predY", "mu")
model.loc = ("ss_model.txt")
mod_ss_forecast = jags.model(file = "model.jag",
data = jags.dat,
inits = jags.ini,
n.chains = 3,
n.adapt = 5000)
mod_ss_forecast
jags.res <- coda.samples( jags.mod,
var = jags.params,
n.iter = 10000,
thin = 1 )
jags.res
summary(jags.res)
N=20
jags.data = list(Y = c(air.test$fatal, NA, NA, NA, NA, NA, NA), N = (N + 6))
jags.params = c("sd.q", "sd.r", "predY", "mu")
model.loc = ("ss_model.txt")
mod_ss_forecast = jags.model(file = "model.jag",
data = jags.dat,
inits = jags.ini,
n.chains = 3,
n.adapt = 5000)
jags.res <- coda.samples( jags.mod,
var = jags.params,
n.iter = 10000,
thin = 1 )
summary(jags.res)
jags.params = c("sd.obs", "predY", "mu", "beta")
jags.ini <- list( list( mu=0.1, beta=0.01,tau.obs=0.01,sd.obs=0.2 ),
list( mu=0.2, beta=0.02 ,tau.obs=0.02,sd.obs=0.2),
list( mu=0.5, beta=0.03 ,tau.obs=0.03,sd.obs=0.2) )
# mod_lm = jags.model(data= jags.data,  = jags.params, file = "model.jag",
#               n.chains = 3, n.adapt = 5000, n.thin = 1, n.iter = 10000)
jags.mod <- jags.model( file = "model.jag",
data = jags.dat,
inits = jags.ini,
n.chains = 3,
n.adapt = 1000 )
jags.res <- coda.samples( jags.mod,
var = jags.params,
n.iter = 10000,
thin = 1 )
jags.ini <- list( list( mu=0.1, beta=0.01,tau.obs=0.01 ),
list( mu=0.2, beta=0.02 ,tau.obs=0.02),
list( mu=0.5, beta=0.03 ,tau.obs=0.03 )
jags.ini <- list( list( mu=0.1, beta=0.01,tau.obs=0.01 ),
list( mu=0.2, beta=0.02 ,tau.obs=0.02),
list( mu=0.5, beta=0.03 ,tau.obs=0.03 )
# mod_lm = jags.model(data= jags.data,  = jags.params, file = "model.jag",
#               n.chains = 3, n.adapt = 5000, n.thin = 1, n.iter = 10000)
jags.mod <- jags.model( file = "model.jag",
data = jags.dat,
inits = jags.ini,
n.chains = 3,
n.adapt = 1000 )
jags.ini <- list( list( mu=0.1, beta=0.01,tau.obs=0.01 ),
list( mu=0.5, beta=0.03 ,tau.obs=0.03 )
# mod_lm = jags.model(data= jags.data,  = jags.params, file = "model.jag",
#               n.chains = 3, n.adapt = 5000, n.thin = 1, n.iter = 10000)
jags.mod <- jags.model( file = "model.jag",
data = jags.dat,
inits = jags.ini,
n.chains = 3,
n.adapt = 1000 )
jags.ini <- list( list( mu=0.1, beta=0.01,tau.obs=0.01 ),
list( mu=0.2, beta=0.02 ,tau.obs=0.02),
list( mu=0.5, beta=0.03 ,tau.obs=0.03 ))
# mod_lm = jags.model(data= jags.data,  = jags.params, file = "model.jag",
#               n.chains = 3, n.adapt = 5000, n.thin = 1, n.iter = 10000)
jags.mod <- jags.model( file = "model.jag",
data = jags.dat,
inits = jags.ini,
n.chains = 3,
n.adapt = 1000 )
jags.res <- coda.samples( jags.mod,
var = jags.params,
n.iter = 10000,
thin = 1 )
summary( jags.res )
N
jags.data = list(Y = c(air.test$fatal, NA, NA, NA, NA, NA, NA), N = (N + 6))
jags.params = c("sd.q", "sd.r", "predY", "mu")
model.loc = ("ss_model.txt")
mod_ss_forecast = jags.model(file = "model.jag",
data = jags.dat,
inits = jags.ini,
n.chains = 3,
n.adapt = 5000)
jags.res <- coda.samples( jags.mod,
var = jags.params,
n.iter = 10000,
thin = 1 )
jags.params = c( "predY", "mu")
model.loc = ("ss_model.txt")
mod_ss_forecast = jags.model(file = "model.jag",
data = jags.dat,
inits = jags.ini,
n.chains = 3,
n.adapt = 5000)
jags.res <- coda.samples( jags.mod,
var = jags.params,
n.iter = 10000,
thin = 1 )
summary( jags.res )
summary( jags.res )[,2]
summary( jags.res )[,2:20]
summary( jags.res )[,1:20]
summary( jags.res )[,1]
summary( jags.res )[1]
summary( jags.res )[1][,"mean"]
summary( jags.res )[1][,1]
summary( jags.res )[1][1]
summary( jags.res )$statistics
summary( jags.res )$statistics["mean"]
summary( jags.res )$statistics[,"mean"]
summary( jags.res )$statistics[,"Mean"]
resid = summary( jags.res )$statistics[,"Mean"][2:]
resid = summary( jags.res )$statistics[,"Mean"][2:20]
resid
as.numeric(resid)
yres = as.numeric(resid)
air.train$fatal
plot(yres,air.train$fatal)
lenght(air.train$fatal)
length(air.train$fatal)
length(yres)
resid = summary( jags.res )$statistics[,"Mean"][2:21]
yres = as.numeric(resid)
length(air.train$fatal)
length(yres)
plot(yres,air.train$fatal)
plot(yres,air.train$fatal)
library("rjags")
mod_string= "model{     # likelihood     for(i in i:length(fatal)){
fatal[i] ~ dpois(lam[i])         log(lam[i]) = alpha + beta1*miles[i] +
beta2*rate[i] + beta3*miles[i]*rate[i]}
alpha ~ dnorm(0.0,0.00001)
beta1 ~dnorm(0.0,0.001)
beta2~dnorm(0.0,0.001)
beta3~dnorm(0.0,0.001)
}"
data_jags= as.list(badhealth)
data_jags= as.list(air.train)
params = c( "alpha", "beta1", "beta3" ,  "beta3")
mod = jags.model(textConnection(mod_string),data = data_jags, n.chains=3)
data_jags
str(air.train)
mod = jags.model(textConnection(mod_string),data = data_jags, n.chains=3)
mod_string= "model{
for(i in i:length(fatal)){
fatal[i] ~ dpois(lam[i])
log(lam[i]) = alpha + beta1*miles[i] +beta2*rate[i]   }
alpha ~ dnorm(0.0,0.00001)
beta1 ~dnorm(0.0,0.001)
beta2~dnorm(0.0,0.001)
beta3~dnorm(0.0,0.001)
}"
data_jags= as.list(air.train)
params = c( "alpha", "beta1", "beta3" ,  "beta3")
mod = jags.model(textConnection(mod_string),data = data_jags, n.chains=3)
mod_string= "model{
for(i in i:20){
fatal[i] ~ dpois(lam[i])
log(lam[i]) = alpha + beta1*miles[i] +beta2*rate[i]   }
alpha ~ dnorm(0.0,0.00001)
beta1 ~dnorm(0.0,0.001)
beta2~dnorm(0.0,0.001)
beta3~dnorm(0.0,0.001)
}"
mod_string= "model{
for(i in i:20){
fatal[i] ~ dpois(lam[i])
log(lam[i]) = alpha + beta1*miles[i] +beta2*rate[i]   }
alpha ~ dnorm(0.0,0.00001)
beta1 ~dnorm(0.0,0.001)
beta2~dnorm(0.0,0.001)
beta3~dnorm(0.0,0.001)
}"
data_jags= as.list(air.train)
params = c( "alpha", "beta1", "beta3" ,  "beta3")
mod = jags.model(textConnection(mod_string),data = data_jags, n.chains=3)
data_jags= list(fatal = air.train$fatal,miles = air.train$miles, rate = air.train$rate)
mod = jags.model(textConnection(mod_string),data = data_jags, n.chains=3)
mod_string= cat("model{
for(i in i:N){
fatal[i] ~ dpois(lam[i])
log(lam[i]) = alpha + beta1*miles[i] +beta2*rate[i]   }
alpha ~ dnorm(0.0,0.00001)
beta1 ~dnorm(0.0,0.001)
beta2~dnorm(0.0,0.001)
beta3~dnorm(0.0,0.001)
}",file = "cur.jag")
data_jags= list(N=20,fatal = air.train$fatal,miles = air.train$miles, rate = air.train$rate)
params = c( "alpha", "beta1", "beta3" ,  "beta3")
mod_string= "model{
for(i in i:length(fatal)){
fatal[i] = dpois(lam[i])
log(lam[i]) = alpha + beta1*miles[i] +beta2*rate[i]   }
alpha =dnorm(0.0,0.00001)
beta1 =dnorm(0.0,0.001)
beta2 =dnorm(0.0,0.001)
beta3=dnorm(0.0,0.001)
}"
data_jags= as.list(air.train)
params = c( "alpha", "beta1", "beta3" ,  "beta3")
mod = jags.model(textConnection(mod_string),data = data_jags, n.chains=3)
mod = jags.model(file = "cur.jag",
data = data_jags,
n.chains=3,
n.adapt = 1000)
mod = jags.model(file = "cur.jag",
data = data_jags,
n.chains=1,
n.adapt = 1000)
mod = jags.model(file = "cur.jag",
data = data_jags,
n.chains=1,
n.adapt = 1000)
summary(mod_ss_forecast)
beta0 <- 1  # intercept
beta1 <- 1  # slope
mu <- beta0*1 + beta1*air.train$miles  # linear predictor function
lambda <- exp(mu)  # CEF
dat <- air.train
N=nrow(air.train)
cat("model{
## Likelihood
for(i in 1:N){
fatal[i] ~ dpois(lambda[i])
log(lambda[i]) <- mu[i]
mu[i] <- beta0+beta1*miles[i]
}
## Prior
beta0 ~ dnorm(0.01,2)  #  Normal prior
beta1 ~ dnorm(0.01,2)
}" , file = "count.jag")
count.par = c("beta0","beta1")
count.dat <- list(miles=cbind(dat$miles),  # predictors
fatal=dat$fatal,  # DV
N=N)  # sample size
# mu.beta=c(0.1,2),  # priors centered on 0
# tau.beta=c(0.0001,2))  # diffuse priors
library(rjags)
jagsmodel <- jags.model(file = "count.jag",  # compile model
data=count.dat,n.chains = 2,n.adapt = 1000)
miles.new = c(19.775,23.300,20.300)
cat("model {
trend[1] <- beta0 + beta1 * miles[1]
for( i in 2 : N ) {
fatal[i] ~ dnorm( mu[i] , tau)
mu[i] <- trend[i] + ar1 * ( fatal[i-1] - trend[i-1] )
trend[i] <- beta0 + beta1 * miles[i]
}
ar1 ~ dunif(-1.1,1.1)
beta0 ~ dnorm( 0 , 1.0E-12 )
beta1 ~ dnorm( 0 , 1.0E-12 )
tau ~ dgamma( 0.001 , 0.001 )}" ,file= "ar1_pred.jag")
ar1_pred.par <- c("ar1","beta0", "beta1", "tau")
ar1_pred.ini <- list( list( ar1=0.01, beta0=0.01, beta1 = 0.01,tau=0.01 ))
ar1_pred.dat <- list( fatal=c(airline$fatal,NA,NA,NA),
miles=c(airline$miles,miles.new),
N= 26+3)
#mod.forecast = jags.model(ar1_pred.dat,parameters.to.save = ar1_pred.par,mode)
ar1_pred.mod <- jags.model( file = "ar1_pred.jag",
data = ar1_pred.dat,
inits = ar1_pred.ini,
n.chains =1,
n.adapt = 1000 )
ar1_pred.res <- coda.samples( model = ar1_pred.mod,
var = ar1_pred.par,
n.iter = 10000,
thin = 10 )
summary(ar1_pred.mod)
summary(ar1_pred.res)
summary(model2)
cat( "model
{
for( i in 1:I )
{
fatal[i] ~ dpois( mu[i] )
log(mu[i]) <- alpha + beta * miles[i]
}
alpha ~ dnorm(0,0.000001)
beta ~ dnorm(0,0.000001)
}",
file="a3.jag" )
a3.dat <- list( fatal=c(airline$fatal,NA),
miles=c(airline$miles,20), I=27 )
a3.par <- c("alpha","beta","fatal[27]")
# Model compilation and burn-in
a3.mod <- jags.model(file = "a2.jag",
data = a2.dat,
inits.fn = NULL,
n.chains = 3,
n.adapt = 1000 )
```{r}
cat( "model
{
for( i in 1:I )
{
fatal[i] ~ dpois( mu[i] )
log(mu[i]) <- alpha + beta * miles[i]
}
alpha ~ dnorm(0,0.000001)
beta ~ dnorm(0,0.000001)
}",
file="a3.jag" )
ciao
miles.new
cat( "model
{
for( i in 1:I )
{
fatal[i] ~ dpois( mu[i] )
log(mu[i]) <- alpha + beta * miles[i]
}
alpha ~ dnorm(0,0.000001)
beta ~ dnorm(0,0.000001)
}",
file="a3.jag" )
a3.ini= list(
list(alpha = 0.01, beta = 0.01),
list(aplha = 0.2, beta = 0.2),
list(aplha = 0.7, beta = 0.7)
)
a3.dat <- list( fatal=c(airline$fatal,NA), miles=c(airline$miles,19,775), I=27 )
a3.par <- c("alpha","beta","fatal[27]")
# Model compilation and burn-in
a3.mod <- jags.model(file = "a3.jag",data = a3.dat,inits = a3.ini,n.chains = 3,n.adapt = 1000 )
#install.packages("rjags","coda","Epi","lme4","pixmap","sp")
library(ggplot2)
library(ggfortify)
library(ggpubr)
library("ggmcmc")
library(rjags)
library(ggplot2)
library(knitr)
library(pander)
library(lattice)
airline <- read.table("http://www.uta.fi/sis/mtt/mttts12/jags/airline.txt",h=T,sep="")
# Model compilation and burn-in
a3.mod <- jags.model(file = "a3.jag",data = a3.dat,inits = a3.ini,n.chains = 3,n.adapt = 1000 )
# Sampling from the posterior
a3.res <- coda.samples( a3.mod,var = a3.par,n.iter = 10000,thin = 10 )summary( a3.res )
# Sampling from the posterior
a3.res <- coda.samples( a3.mod,var = a3.par,n.iter = 10000,thin = 10 )
summary( a3.res )
library(rjags)
cat( "model
{
for( i in 1:I )
{
fatal[i] ~ dnorm( mu[i],1/mu[i] )
mu[i] <- alpha + beta2 * miles[i]*rate[i]
}
alpha ~ dnorm(0,0.0001)
beta2 ~ dnorm(0,0.0001)
}",
file="a4.jag" )
a4.ini= list(
list(alpha = 0.01, beta2=3),
list(alpha = 0.2, beta2=1),
list(alpha = 0.7, beta2=2))
a4.dat <- list( rate = c(airline$rate,0.7080,0.3),fatal=c(airline$fatal,NA,NA), miles=c(airline$miles,19.775,23.300), I=28 )
a4.par <- c("alpha","beta","beta2","fatal[27]","fatal[28]")
# Model compilation and burn-in
a4.mod <- jags.model(file = "a4.jag",data = a4.dat,inits = a4.ini,n.chains = 3,n.adapt = 1000 )
# Sampling from the posterior
update(a4.mod,1000)
a4.res <- coda.samples( a4.mod,var = a4.par,n.iter = 3000,thin = 10 )
library(rjags)
cat( "model
{
for( i in 1:I )
{
fatal[i] ~ dnorm( mu[i],1/mu[i] )
mu[i] <- alpha + beta2 * miles[i]*rate[i]
}
alpha ~ dnorm(0,0.0001)
beta2 ~ dnorm(0,0.0001)
}",
file="a4.jag" )
a4.ini= list(
list(alpha = 0.01, beta2=3),
list(alpha = 0.2, beta2=1),
list(alpha = 0.7, beta2=2))
a4.dat <- list( rate = c(airline$rate,0.7080,0.3),fatal=c(airline$fatal,NA,NA), miles=c(airline$miles,19.775,23.300), I=28 )
a4.par <- c("alpha","beta2","fatal[27]","fatal[28]")
# Model compilation and burn-in
a4.mod <- jags.model(file = "a4.jag",data = a4.dat,inits = a4.ini,n.chains = 3,n.adapt = 1000 )
# Sampling from the posterior
update(a4.mod,1000)
a4.res <- coda.samples( a4.mod,var = a4.par,n.iter = 3000,thin = 10 )
library(rjags)
cat( "model
{
for( i in 1:I )
{
fatal[i] ~ dnorm( mu[i],1/mu[i] )
mu[i] <- alpha + beta2 * miles[i]
}
alpha ~ dnorm(0,0.0001)
beta2 ~ dnorm(0,0.0001)
}",
file="a4.jag" )
a4.ini= list(
list(alpha = 0.01, beta2=3),
list(alpha = 0.2, beta2=1),
list(alpha = 0.7, beta2=2))
a4.dat <- list( rate = c(airline$rate,0.7080,0.3),fatal=c(airline$fatal,NA,NA), miles=c(airline$miles,19.775,23.300), I=28 )
a4.par <- c("alpha","beta2","fatal[27]","fatal[28]")
# Model compilation and burn-in
a4.mod <- jags.model(file = "a4.jag",data = a4.dat,inits = a4.ini,n.chains = 3,n.adapt = 1000 )
# Sampling from the posterior
update(a4.mod,1000)
a4.res <- coda.samples( a4.mod,var = a4.par,n.iter = 3000,thin = 10 )
summary( a4.res )
#predictions
